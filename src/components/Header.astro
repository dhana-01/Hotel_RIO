---
const { theme = 'light' } = Astro.props;
const textColorClass = theme === 'dark' ? 'text-rio-black' : 'text-white';
const mobileMenuColorClass = theme === 'dark' ? 'text-rio-black' : 'text-white';
---

<header class="fixed w-full z-50 transition-all duration-500 bg-transparent" id="main-header" data-theme={theme}>
  <div class="container mx-auto px-6 py-6 flex justify-between items-center transition-all duration-500" id="header-container">
    
    <!-- Logo (Left) -->
    <a href="/" class="block">
      <img src="/images/logo.png" alt="Hotel Rio Logo" class="h-20 w-auto object-contain drop-shadow-2xl transition-all duration-500" id="header-logo" />
    </a>

    <!-- Links (Right) + CTA -->
    <div class="flex items-center space-x-10">
      <nav class="hidden md:flex space-x-10">
        <!-- Reordered Links: Home, About, Rooms, Location, Dining -->
        <a href="/" class={`nav-link group relative ${textColorClass} hover:text-rio-red transition font-sans text-sm tracking-[0.2em] uppercase py-2 font-medium drop-shadow-md`}>
          Home
          <span class="absolute bottom-0 left-0 w-full h-0.5 bg-rio-red transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
        </a>
        <a href="/about" class={`nav-link group relative ${textColorClass} hover:text-rio-red transition font-sans text-sm tracking-[0.2em] uppercase py-2 font-medium drop-shadow-md`}>
          About
          <span class="absolute bottom-0 left-0 w-full h-0.5 bg-rio-red transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
        </a>
        <a href="/#rooms" class={`nav-link group relative ${textColorClass} hover:text-rio-red transition font-sans text-sm tracking-[0.2em] uppercase py-2 font-medium drop-shadow-md`}>
          Rooms
          <span class="absolute bottom-0 left-0 w-full h-0.5 bg-rio-red transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
        </a>
        <a href="/#location" class={`nav-link group relative ${textColorClass} hover:text-rio-red transition font-sans text-sm tracking-[0.2em] uppercase py-2 font-medium drop-shadow-md`}>
          Location
          <span class="absolute bottom-0 left-0 w-full h-0.5 bg-rio-red transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
        </a>
        <a href="/#dining" class={`nav-link group relative ${textColorClass} hover:text-rio-red transition font-sans text-sm tracking-[0.2em] uppercase py-2 font-medium drop-shadow-md`}>
          Dining
          <span class="absolute bottom-0 left-0 w-full h-0.5 bg-rio-red transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
        </a>
        <a href="/contact" class={`nav-link group relative ${textColorClass} hover:text-rio-red transition font-sans text-sm tracking-[0.2em] uppercase py-2 font-medium drop-shadow-md`}>
          Contact
          <span class="absolute bottom-0 left-0 w-full h-0.5 bg-rio-red transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
        </a>
      </nav>

      <a href="/#book" class="hidden md:inline-block px-8 py-3 bg-rio-red hover:bg-rio-red-dark text-white font-sans text-sm tracking-widest uppercase transition-all duration-300 shadow-lg hover:shadow-rio-red/50 hover:-translate-y-0.5 border border-transparent hover:border-white/20">
        Book Now
      </a>
      
      <!-- Mobile Menu Button -->
      <button class={`md:hidden ${mobileMenuColorClass} focus:outline-none drop-shadow-md z-50 relative`} aria-label="Open Menu" id="mobile-menu-btn">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile Menu Overlay -->
  <div id="mobile-menu-overlay" class="fixed inset-0 bg-rio-black/95 z-40 transform translate-x-full transition-transform duration-300 md:hidden flex items-center justify-center">
    <nav class="flex flex-col items-center space-y-8">
      <a href="/" class="mobile-nav-link text-3xl font-serif text-white hover:text-rio-red transition-colors">Home</a>
      <a href="/about" class="mobile-nav-link text-3xl font-serif text-white hover:text-rio-red transition-colors">About</a>
      <a href="/#rooms" class="mobile-nav-link text-3xl font-serif text-white hover:text-rio-red transition-colors">Rooms</a>
      <a href="/#location" class="mobile-nav-link text-3xl font-serif text-white hover:text-rio-red transition-colors">Location</a>
      <a href="/#dining" class="mobile-nav-link text-3xl font-serif text-white hover:text-rio-red transition-colors">Dining</a>
      <a href="/contact" class="mobile-nav-link text-3xl font-serif text-white hover:text-rio-red transition-colors">Contact</a>
      <a href="/#book" class="px-8 py-3 bg-rio-red text-white font-sans text-sm tracking-widest uppercase shadow-lg">Book Now</a>
    </nav>
  </div>
</header>

<script>
  const header = document.getElementById("main-header");
  const container = document.getElementById("header-container");
  const logo = document.getElementById("header-logo");
  const navLinks = document.querySelectorAll(".nav-link");
  const mobileMenuBtn = document.getElementById("mobile-menu-btn");
  const mobileMenuOverlay = document.getElementById("mobile-menu-overlay");
  const mobileNavLinks = document.querySelectorAll(".mobile-nav-link");
  
  const initialTheme = header?.dataset.theme || 'light';

  // Toggle Mobile Menu
  if (mobileMenuBtn && mobileMenuOverlay) {
    mobileMenuBtn.addEventListener('click', () => {
      const isClosed = mobileMenuOverlay.classList.contains('translate-x-full');
      if (isClosed) {
        mobileMenuOverlay.classList.remove('translate-x-full');
        // Change icon to close (X)
        mobileMenuBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>`;
      } else {
        mobileMenuOverlay.classList.add('translate-x-full');
        // Change icon back to hamburger
        mobileMenuBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>`;
      }
    });

    // Close menu when a link is clicked
    mobileNavLinks.forEach(link => {
      link.addEventListener('click', () => {
        mobileMenuOverlay.classList.add('translate-x-full');
        mobileMenuBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>`;
      });
    });
  }

  const updateColors = (isSticky) => {
      // If sticky, always white text (on dark bg). 
      // If not sticky, use initial theme color.
      const targetColorClass = isSticky ? 'text-white' : (initialTheme === 'dark' ? 'text-rio-black' : 'text-white');
      const textToRemove = targetColorClass === 'text-white' ? 'text-rio-black' : 'text-white';

      navLinks.forEach(link => {
          link.classList.remove(textToRemove);
          link.classList.add(targetColorClass);
      });

      if (mobileMenuBtn) {
          mobileMenuBtn.classList.remove(textToRemove);
          mobileMenuBtn.classList.add(targetColorClass);
      }
  };

  if (header && container && logo) {
      window.addEventListener("scroll", () => {
        // Trigger after scrolling past 90px (not full viewport, earlier usually better for sticky)
        // Or keep original logic if user prefers full hero scroll? 
        // Original was window.innerHeight * 0.9.
        // For Contact page (no hero), this threshold might be too large. 
        // Let's use a smaller threshold if theme is dark (since no hero).
        
        const threshold = initialTheme === 'dark' ? 100 : window.innerHeight * 0.9;

        if (window.scrollY > threshold) {
          header.classList.remove("bg-transparent");
          header.classList.add("bg-rio-black/95", "backdrop-blur-md", "shadow-xl");
          
          container.classList.remove("py-6");
          container.classList.add("py-3"); // Shrink container
          
          logo.classList.replace("h-20", "h-14"); // Shrink logo
          
          updateColors(true); // Sticky -> White text
        } else {
          header.classList.add("bg-transparent");
          header.classList.remove("bg-rio-black/95", "backdrop-blur-md", "shadow-xl");
          
          container.classList.add("py-6");
          container.classList.remove("py-3");
          
          logo.classList.replace("h-14", "h-20");
          
          updateColors(false); // Not sticky -> Initial theme text
        }
      });
  }
</script>
